# Standard Coder Platform - Pipeline Configuration (example: freeCodeCamp/freeCodeCamp)
#
# Repo (via `gh repo view`):
# - name: freeCodeCamp/freeCodeCamp
# - primary language: TypeScript
# - other languages: JavaScript, CSS, HTML, Shell, Dockerfile
#
# Note: this pipelineâ€™s mining language inference currently buckets TS+JS as "javascript".
#
# Run:
#   standard-coder pipeline --config pipeline_config.freecodecamp.toml --stages mine
#   standard-coder pipeline --config pipeline_config.freecodecamp.toml --stages train_sch

[repos]
source = "github"
include_github_repos = ["freeCodeCamp/freeCodeCamp"]
exclude_github_repos = []
mirror_clone = true
git_fetch_prune = true

# Successful run complete: switch to a higher-quality default.
# (You can always lower these again for fast iteration.)
max_commits_per_repo = 10000

[filters.authors]
include = []
exclude = ["bot", "dependabot", "renovate", "github-actions"]

[filters.repos]
include = ["freeCodeCamp/freeCodeCamp"]
exclude = []

[filters.languages]
# Maps TypeScript/JavaScript -> "javascript" in this codebase.
include = ["javascript"]
exclude = ["unknown"]

[outputs]
base_dir = "~/.standard_coder_freecodecamp"

[training]
predictor_kind = "mdn"

# This has a big effect on dataset size + runtime.
label_samples_per_commit = 3
rng_seed = 123

[training.hmm]
kind = "hmm"
step_minutes = 5
epochs = 80
lr = 0.01
hidden_size = 16
min_commits_per_author = 100
device = "mps"
# Fit per-author HMMs in parallel on CPU.
# Note: for torch MPS/CUDA devices this falls back to 1 worker.
parallel_authors = 1

[training.change_rep]
# Upgrade A is Python-specific; disable for TS/JS repos.
use_upgrade_a = false
tokens_max_features = 2048
tokens_min_df = 5

[training.mdn]
n_components = 10
hidden_sizes = [128, 64, 64]
epochs = 30
lr = 0.001
batch_size = 512
truncate_low = 0.0
truncate_high = 1.0
device = "mps"
# PyTorch DataLoader workers (CPU-side prefetch). Often best left at 0 on small datasets.
dataloader_num_workers = 0

[checkpointing]
save_every_epochs = 1
resume = true

[forecasting]
enable = false
